(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1662:(e,t,r)=>{Promise.resolve().then(r.bind(r,4898))},4898:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var n=r(5155),o=r(2619),i=r.n(o),a=r(1138),s=r(7621);let l=(0,a.v)()((e,t)=>({file:null,script:"",phase:"idle",logs:[],errorMessage:null,runId:null,shorts:[],setFile:t=>e({file:t}),setScript:t=>e({script:t}),reset:()=>e({file:null,script:"",phase:"idle",logs:[],errorMessage:null,runId:null,shorts:[]}),process:async()=>{let{file:r,script:n}=t();if(r&&n.trim())try{e({phase:"uploading",logs:["Uploading video..."],errorMessage:null});let{runId:t}=await s.tt(r,n);e(e=>({runId:t,logs:[...e.logs,"Upload complete. Run: ".concat(t)]})),e(e=>({phase:"transcribing",logs:[...e.logs,"Starting transcription (whisper.cpp)..."]})),await c("transcribe",t,e),e(e=>({phase:"aligning",logs:[...e.logs,"Aligning script to transcript..."]})),await c("align",t,e);let o=await s.u2(t);e(e=>({phase:"done",shorts:o,logs:[...e.logs,"Done! ".concat(o.length," short(s) generated.")]}))}catch(t){e(e=>({phase:"error",errorMessage:t.message||"Processing failed",logs:[...e.logs,"Error: ".concat(t.message)]}))}}}));function c(e,t,r){return new Promise(async(n,o)=>{try{let{jobId:i}=await s.jn(e,{runId:t}),a=new EventSource(s.S0(e,i));a.onmessage=t=>{try{let i=JSON.parse(t.data);"log"===i.type?r(e=>({logs:[...e.logs,i.data]})):"done"===i.type?(a.close(),n()):"error"===i.type&&(a.close(),o(Error("".concat(e," failed"))))}catch(e){r(e=>({logs:[...e.logs,t.data]}))}},a.onerror=()=>{a.close(),o(Error("".concat(e," stream error")))}}catch(e){o(e)}})}var d=r(2115);function p(){var e;let t=l(e=>e.file),r=l(e=>e.setFile),o=l(e=>e.phase),[i,a]=(0,d.useState)(!1),s=(0,d.useRef)(null),c="idle"!==o,p=(0,d.useCallback)(e=>{!c&&(!e||e.type.startsWith("video/"))&&r(e)},[r,c]),u=(0,d.useCallback)(e=>{e.preventDefault(),a(!1);let t=e.dataTransfer.files[0];t&&p(t)},[p]),g=(0,d.useCallback)(e=>{e.preventDefault(),c||a(!0)},[c]),h=(0,d.useCallback)(()=>a(!1),[]);return(0,n.jsxs)("div",{onDrop:u,onDragOver:g,onDragLeave:h,onClick:()=>{var e;return!c&&(null==(e=s.current)?void 0:e.click())},style:{border:"2px dashed ".concat(i?"var(--accent)":t?"var(--success)":"var(--border)"),background:i?"var(--accent-muted)":"var(--bg-tertiary)",borderRadius:12,padding:"40px 24px",textAlign:"center",cursor:c?"default":"pointer",transition:"all 0.2s ease",opacity:c?.6:1},children:[(0,n.jsx)("input",{ref:s,type:"file",accept:"video/*",onChange:e=>{var t,r;return p(null!=(r=null==(t=e.target.files)?void 0:t[0])?r:null)},style:{display:"none"},disabled:c}),t?(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontSize:32,marginBottom:8,filter:"grayscale(1) brightness(1.5)"},children:(0,n.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"var(--success)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),(0,n.jsx)("polyline",{points:"22 4 12 14.01 9 11.01"})]})}),(0,n.jsx)("p",{style:{color:"var(--text-primary)",fontSize:14,fontWeight:500,margin:"0 0 4px"},children:t.name}),(0,n.jsx)("p",{style:{color:"var(--text-muted)",fontSize:13,margin:0},children:(e=t.size)>0x40000000?"".concat((e/1024/1024/1024).toFixed(1)," GB"):"".concat((e/1024/1024).toFixed(1)," MB")}),!c&&(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),r(null)},style:{marginTop:12,padding:"4px 12px",fontSize:12,color:"var(--text-secondary)",background:"var(--bg-elevated)",borderRadius:6},children:"Change file"})]}):(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{marginBottom:12},children:(0,n.jsxs)("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"var(--text-muted)",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,n.jsx)("polyline",{points:"17 8 12 3 7 8"}),(0,n.jsx)("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),(0,n.jsx)("p",{style:{color:"var(--text-primary)",fontSize:14,fontWeight:500,margin:"0 0 4px"},children:"Drop your a-roll video here"}),(0,n.jsx)("p",{style:{color:"var(--text-muted)",fontSize:13,margin:0},children:"or click to browse"})]})]})}function u(){let e=l(e=>e.script),t=l(e=>e.setScript),r="idle"!==l(e=>e.phase),o=e.split(/\n\s*\n/).filter(e=>e.trim().length>0).length;return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:8},children:[(0,n.jsx)("label",{style:{fontSize:13,fontWeight:500,color:"var(--text-primary)"},children:"Your script"}),e.trim().length>0&&(0,n.jsxs)("span",{style:{fontSize:12,color:"var(--text-muted)"},children:[o," section",1!==o?"s":""," (split by blank lines)"]})]}),(0,n.jsx)("textarea",{value:e,onChange:e=>t(e.target.value),disabled:r,placeholder:"Paste the script you wrote before recording.\n\nSeparate sections with blank lines â€” each section becomes a separate short.\n\nExample:\n\nReact hooks allow you to use state and lifecycle features in functional components. The most common hook is useState...\n\nThe useEffect hook lets you perform side effects in your components. It runs after every render by default...",style:{width:"100%",minHeight:200,maxHeight:400,resize:"vertical",fontFamily:"inherit",lineHeight:1.6,opacity:r?.6:1}})]})}let g=[{key:"uploading",label:"Upload video"},{key:"transcribing",label:"Transcribe audio"},{key:"aligning",label:"Align script"},{key:"done",label:"Complete"}];function h(){let e=l(e=>e.phase),t=l(e=>e.logs),r=l(e=>e.errorMessage),o=(0,d.useRef)(null);return((0,d.useEffect)(()=>{var e;null==(e=o.current)||e.scrollIntoView({behavior:"smooth"})},[t.length]),"idle"===e)?null:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{display:"flex",gap:4,marginBottom:16},children:g.map(t=>{let r=function(e,t){let r=g.map(e=>e.key),n=r.indexOf(t),o=r.indexOf(e);return"error"===t?o<n?"done":o===n?"error":"pending":o<n?"done":o===n?"active":"pending"}(t.key,e);return(0,n.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[(0,n.jsx)("div",{style:{height:3,width:"100%",borderRadius:2,background:"done"===r?"var(--success)":"active"===r?"var(--accent)":"error"===r?"var(--error)":"var(--border)",transition:"background 0.3s ease"}}),(0,n.jsx)("span",{style:{fontSize:11,color:"active"===r?"var(--accent)":"done"===r?"var(--success)":"error"===r?"var(--error)":"var(--text-muted)",fontWeight:"active"===r?600:400},children:t.label})]},t.key)})}),r&&(0,n.jsx)("div",{style:{padding:"10px 14px",borderRadius:8,background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",color:"var(--error)",fontSize:13,marginBottom:12},children:r}),(0,n.jsxs)("div",{style:{background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:8,padding:12,maxHeight:200,overflowY:"auto",fontFamily:"ui-monospace, 'SF Mono', Menlo, monospace",fontSize:11,lineHeight:1.5,color:"var(--text-secondary)"},children:[t.map((e,t)=>(0,n.jsx)("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-all"},children:e},t)),(0,n.jsx)("div",{ref:o})]})]})}var x=r(63);function f(){let e=l(e=>e.shorts),t=l(e=>e.runId),r=l(e=>e.phase),o=(0,x.useRouter)();return"done"!==r||0===e.length?null:(0,n.jsxs)("div",{children:[(0,n.jsxs)("h2",{style:{fontSize:16,fontWeight:600,color:"var(--text-primary)",margin:"0 0 12px"},children:[e.length," short",1!==e.length?"s":""," generated"]}),(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:e.map(e=>{let r=e.segmentsToKeep.reduce((e,t)=>e+(t.end-t.start),0),i=Math.floor(r/60),a=Math.round(r%60);return(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"12px 16px",background:"var(--bg-tertiary)",border:"1px solid var(--border)",borderRadius:10},children:[(0,n.jsx)("div",{style:{width:32,height:32,borderRadius:8,background:"var(--accent-muted)",color:"var(--accent)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:14,flexShrink:0},children:e.id}),(0,n.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,n.jsx)("p",{style:{margin:0,fontSize:14,fontWeight:500,color:"var(--text-primary)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.title}),(0,n.jsxs)("p",{style:{margin:"2px 0 0",fontSize:12,color:"var(--text-muted)"},children:[i,":",a.toString().padStart(2,"0")," \xb7"," ",e.segmentsToKeep.length," segment",1!==e.segmentsToKeep.length?"s":""," \xb7"," ",e.subtitleWords.length," words"]})]}),(0,n.jsx)("button",{onClick:()=>o.push("/editor?run=".concat(t,"&short=").concat(e.id)),style:{padding:"6px 14px",fontSize:13,fontWeight:500,color:"var(--accent)",background:"var(--accent-muted)",borderRadius:6,transition:"background 0.15s",flexShrink:0},onMouseEnter:e=>e.currentTarget.style.background="rgba(99, 102, 241, 0.25)",onMouseLeave:e=>e.currentTarget.style.background="var(--accent-muted)",children:"Open in Editor"})]},e.id)})})]})}function y(){let e=l(e=>e.file),t=l(e=>e.script),r=l(e=>e.phase),o=l(e=>e.process),a=l(e=>e.reset),s=null!==e&&t.trim().length>0&&"idle"===r;return(0,n.jsxs)("div",{style:{minHeight:"100vh",background:"var(--bg-primary)",overflowY:"auto"},children:[(0,n.jsxs)("header",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 24px",borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:[(0,n.jsx)("div",{style:{display:"flex",alignItems:"center",gap:8},children:(0,n.jsx)("span",{style:{fontSize:14,fontWeight:600,color:"var(--text-primary)"},children:"Video Pipeline"})}),(0,n.jsx)(i(),{href:"/editor",style:{fontSize:13,color:"var(--text-secondary)",textDecoration:"none",padding:"4px 10px",borderRadius:6,border:"1px solid var(--border)"},children:"Open Editor"})]}),(0,n.jsxs)("main",{style:{maxWidth:640,margin:"0 auto",padding:"48px 24px 80px",display:"flex",flexDirection:"column",gap:28},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{style:{fontSize:28,fontWeight:700,color:"var(--text-primary)",margin:"0 0 6px",letterSpacing:"-0.02em"},children:"Create shorts from your recording"}),(0,n.jsx)("p",{style:{fontSize:14,color:"var(--text-secondary)",margin:0,lineHeight:1.5},children:"Upload your a-roll video and paste the script you recorded from. The tool will transcribe, find the best takes, remove silences, and split into shorts."})]}),(0,n.jsx)(p,{}),(0,n.jsx)(u,{}),(0,n.jsxs)("div",{style:{display:"flex",gap:10},children:[(0,n.jsx)("button",{onClick:o,disabled:!s,style:{flex:1,padding:"12px 20px",fontSize:15,fontWeight:600,color:s?"#fff":"var(--text-muted)",background:s?"var(--accent)":"var(--bg-elevated)",borderRadius:10,transition:"all 0.15s",cursor:s?"pointer":"default"},children:"uploading"===r||"transcribing"===r||"aligning"===r?"Processing...":"Process"}),("done"===r||"error"===r)&&(0,n.jsx)("button",{onClick:a,style:{padding:"12px 20px",fontSize:15,fontWeight:500,color:"var(--text-secondary)",background:"var(--bg-elevated)",borderRadius:10},children:"Start over"})]}),(0,n.jsx)(h,{}),(0,n.jsx)(f,{})]})]})}},7621:(e,t,r)=>{"use strict";r.d(t,{H7:()=>a,S0:()=>g,SG:()=>p,Y:()=>s,bH:()=>c,jn:()=>u,tt:()=>d,u2:()=>l,v:()=>i});let n="/api";async function o(e,t){let r=await fetch(e,t);if(!r.ok){let e=await r.text();throw Error("".concat(r.status,": ").concat(e))}return r.json()}async function i(){return o("".concat(n,"/runs"))}async function a(e){return o("".concat(n,"/runs/").concat(e,"/transcript"))}async function s(e){return o("".concat(n,"/runs/").concat(e,"/assets"))}async function l(e){return o("".concat(n,"/runs/").concat(e,"/edits"))}async function c(e,t){await o("".concat(n,"/runs/").concat(e,"/edits"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}async function d(e,t){let r=new FormData;r.append("video",e),r.append("script",t);let o=await fetch("".concat(n,"/upload"),{method:"POST",body:r});if(!o.ok){let e=await o.text();throw Error("Upload failed: ".concat(o.status,": ").concat(e))}return o.json()}function p(e){return"".concat(n,"/media?path=").concat(encodeURIComponent(e))}async function u(e,t){return o("".concat(n,"/pipeline/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}function g(e,t){return"".concat(n,"/pipeline/").concat(e,"/stream?jobId=").concat(t)}}},e=>{e.O(0,[889,441,255,358],()=>e(e.s=1662)),_N_E=e.O()}]);