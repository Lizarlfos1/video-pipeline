{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///Users/jimmygrills/Documents/Coding/video-pipeline/web/lib/paths.ts"],"sourcesContent":["import path from \"node:path\";\n\n/** Project root is one level up from /web */\nexport const PROJECT_ROOT = path.resolve(process.cwd(), \"..\");\nexport const RUNS_DIR = path.join(PROJECT_ROOT, \"runs\");\nexport const ASSETS_DIR = path.join(PROJECT_ROOT, \"assets\");\n\n/** Validate a path is within the project root (prevent directory traversal) */\nexport function validatePath(relativePath: string): string | null {\n  const absolute = path.resolve(PROJECT_ROOT, relativePath);\n  if (!absolute.startsWith(PROJECT_ROOT)) return null;\n  return absolute;\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAGO,MAAM,eAAe,4HAAI,CAAC,OAAO,CAAC,QAAQ,GAAG,IAAI;AACjD,MAAM,WAAW,4HAAI,CAAC,IAAI,CAAC,cAAc;AACzC,MAAM,aAAa,4HAAI,CAAC,IAAI,CAAC,cAAc;AAG3C,SAAS,aAAa,YAAoB;IAC/C,MAAM,WAAW,4HAAI,CAAC,OAAO,CAAC,cAAc;IAC5C,IAAI,CAAC,SAAS,UAAU,CAAC,eAAe,OAAO;IAC/C,OAAO;AACT","debugId":null}},
    {"offset": {"line": 85, "column": 0}, "map": {"version":3,"sources":["file:///Users/jimmygrills/Documents/Coding/video-pipeline/web/app/api/media/route.ts"],"sourcesContent":["import { NextRequest } from \"next/server\";\nimport { stat } from \"node:fs/promises\";\nimport { createReadStream } from \"node:fs\";\nimport path from \"node:path\";\nimport { PROJECT_ROOT, validatePath } from \"@/lib/paths\";\n\nconst MIME_TYPES: Record<string, string> = {\n  \".mp4\": \"video/mp4\",\n  \".webm\": \"video/webm\",\n  \".mov\": \"video/quicktime\",\n  \".mp3\": \"audio/mpeg\",\n  \".wav\": \"audio/wav\",\n  \".ogg\": \"audio/ogg\",\n  \".png\": \"image/png\",\n  \".jpg\": \"image/jpeg\",\n  \".jpeg\": \"image/jpeg\",\n  \".gif\": \"image/gif\",\n  \".json\": \"application/json\",\n};\n\nexport async function GET(request: NextRequest) {\n  const filePath = request.nextUrl.searchParams.get(\"path\");\n  if (!filePath) {\n    return new Response(\"Missing path parameter\", { status: 400 });\n  }\n\n  const absolutePath = validatePath(filePath);\n  if (!absolutePath) {\n    return new Response(\"Forbidden\", { status: 403 });\n  }\n\n  try {\n    const fileStat = await stat(absolutePath);\n    const ext = path.extname(absolutePath).toLowerCase();\n    const contentType = MIME_TYPES[ext] || \"application/octet-stream\";\n    const range = request.headers.get(\"range\");\n\n    if (range) {\n      const parts = range.replace(\"bytes=\", \"\").split(\"-\");\n      const start = parseInt(parts[0], 10);\n      const end = parts[1] ? parseInt(parts[1], 10) : fileStat.size - 1;\n      const chunkSize = end - start + 1;\n\n      const stream = createReadStream(absolutePath, { start, end });\n      const readable = new ReadableStream({\n        start(controller) {\n          stream.on(\"data\", (chunk) => {\n            if (typeof chunk === \"string\") {\n              controller.enqueue(new TextEncoder().encode(chunk));\n            } else {\n              controller.enqueue(new Uint8Array(chunk));\n            }\n          });\n          stream.on(\"end\", () => controller.close());\n          stream.on(\"error\", (err) => controller.error(err));\n        },\n      });\n\n      return new Response(readable, {\n        status: 206,\n        headers: {\n          \"Content-Range\": `bytes ${start}-${end}/${fileStat.size}`,\n          \"Accept-Ranges\": \"bytes\",\n          \"Content-Length\": String(chunkSize),\n          \"Content-Type\": contentType,\n        },\n      });\n    }\n\n    const stream = createReadStream(absolutePath);\n    const readable = new ReadableStream({\n      start(controller) {\n        stream.on(\"data\", (chunk) => {\n          if (typeof chunk === \"string\") {\n            controller.enqueue(new TextEncoder().encode(chunk));\n          } else {\n            controller.enqueue(new Uint8Array(chunk));\n          }\n        });\n        stream.on(\"end\", () => controller.close());\n        stream.on(\"error\", (err) => controller.error(err));\n      },\n    });\n\n    return new Response(readable, {\n      headers: {\n        \"Content-Length\": String(fileStat.size),\n        \"Content-Type\": contentType,\n        \"Accept-Ranges\": \"bytes\",\n      },\n    });\n  } catch {\n    return new Response(\"File not found\", { status: 404 });\n  }\n}\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;;;;;AAEA,MAAM,aAAqC;IACzC,QAAQ;IACR,SAAS;IACT,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,SAAS;IACT,QAAQ;IACR,SAAS;AACX;AAEO,eAAe,IAAI,OAAoB;IAC5C,MAAM,WAAW,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;IAClD,IAAI,CAAC,UAAU;QACb,OAAO,IAAI,SAAS,0BAA0B;YAAE,QAAQ;QAAI;IAC9D;IAEA,MAAM,eAAe,IAAA,qIAAY,EAAC;IAClC,IAAI,CAAC,cAAc;QACjB,OAAO,IAAI,SAAS,aAAa;YAAE,QAAQ;QAAI;IACjD;IAEA,IAAI;QACF,MAAM,WAAW,MAAM,IAAA,6IAAI,EAAC;QAC5B,MAAM,MAAM,4HAAI,CAAC,OAAO,CAAC,cAAc,WAAW;QAClD,MAAM,cAAc,UAAU,CAAC,IAAI,IAAI;QACvC,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC;QAElC,IAAI,OAAO;YACT,MAAM,QAAQ,MAAM,OAAO,CAAC,UAAU,IAAI,KAAK,CAAC;YAChD,MAAM,QAAQ,SAAS,KAAK,CAAC,EAAE,EAAE;YACjC,MAAM,MAAM,KAAK,CAAC,EAAE,GAAG,SAAS,KAAK,CAAC,EAAE,EAAE,MAAM,SAAS,IAAI,GAAG;YAChE,MAAM,YAAY,MAAM,QAAQ;YAEhC,MAAM,SAAS,IAAA,iIAAgB,EAAC,cAAc;gBAAE;gBAAO;YAAI;YAC3D,MAAM,WAAW,IAAI,eAAe;gBAClC,OAAM,UAAU;oBACd,OAAO,EAAE,CAAC,QAAQ,CAAC;wBACjB,IAAI,OAAO,UAAU,UAAU;4BAC7B,WAAW,OAAO,CAAC,IAAI,cAAc,MAAM,CAAC;wBAC9C,OAAO;4BACL,WAAW,OAAO,CAAC,IAAI,WAAW;wBACpC;oBACF;oBACA,OAAO,EAAE,CAAC,OAAO,IAAM,WAAW,KAAK;oBACvC,OAAO,EAAE,CAAC,SAAS,CAAC,MAAQ,WAAW,KAAK,CAAC;gBAC/C;YACF;YAEA,OAAO,IAAI,SAAS,UAAU;gBAC5B,QAAQ;gBACR,SAAS;oBACP,iBAAiB,CAAC,MAAM,EAAE,MAAM,CAAC,EAAE,IAAI,CAAC,EAAE,SAAS,IAAI,EAAE;oBACzD,iBAAiB;oBACjB,kBAAkB,OAAO;oBACzB,gBAAgB;gBAClB;YACF;QACF;QAEA,MAAM,SAAS,IAAA,iIAAgB,EAAC;QAChC,MAAM,WAAW,IAAI,eAAe;YAClC,OAAM,UAAU;gBACd,OAAO,EAAE,CAAC,QAAQ,CAAC;oBACjB,IAAI,OAAO,UAAU,UAAU;wBAC7B,WAAW,OAAO,CAAC,IAAI,cAAc,MAAM,CAAC;oBAC9C,OAAO;wBACL,WAAW,OAAO,CAAC,IAAI,WAAW;oBACpC;gBACF;gBACA,OAAO,EAAE,CAAC,OAAO,IAAM,WAAW,KAAK;gBACvC,OAAO,EAAE,CAAC,SAAS,CAAC,MAAQ,WAAW,KAAK,CAAC;YAC/C;QACF;QAEA,OAAO,IAAI,SAAS,UAAU;YAC5B,SAAS;gBACP,kBAAkB,OAAO,SAAS,IAAI;gBACtC,gBAAgB;gBAChB,iBAAiB;YACnB;QACF;IACF,EAAE,OAAM;QACN,OAAO,IAAI,SAAS,kBAAkB;YAAE,QAAQ;QAAI;IACtD;AACF","debugId":null}}]
}