{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 85, "column": 0}, "map": {"version":3,"sources":["file:///Users/jimmygrills/Documents/Coding/video-pipeline/web/lib/paths.ts"],"sourcesContent":["import path from \"node:path\";\n\n/** Project root is one level up from /web */\nexport const PROJECT_ROOT = path.resolve(process.cwd(), \"..\");\nexport const RUNS_DIR = path.join(PROJECT_ROOT, \"runs\");\nexport const ASSETS_DIR = path.join(PROJECT_ROOT, \"assets\");\n\n/** Validate a path is within the project root (prevent directory traversal) */\nexport function validatePath(relativePath: string): string | null {\n  const absolute = path.resolve(PROJECT_ROOT, relativePath);\n  if (!absolute.startsWith(PROJECT_ROOT)) return null;\n  return absolute;\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAGO,MAAM,eAAe,4HAAI,CAAC,OAAO,CAAC,QAAQ,GAAG,IAAI;AACjD,MAAM,WAAW,4HAAI,CAAC,IAAI,CAAC,cAAc;AACzC,MAAM,aAAa,4HAAI,CAAC,IAAI,CAAC,cAAc;AAG3C,SAAS,aAAa,YAAoB;IAC/C,MAAM,WAAW,4HAAI,CAAC,OAAO,CAAC,cAAc;IAC5C,IAAI,CAAC,SAAS,UAAU,CAAC,eAAe,OAAO;IAC/C,OAAO;AACT","debugId":null}},
    {"offset": {"line": 109, "column": 0}, "map": {"version":3,"sources":["file:///Users/jimmygrills/Documents/Coding/video-pipeline/web/app/api/upload/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { mkdir, writeFile } from \"node:fs/promises\";\nimport { createWriteStream } from \"node:fs\";\nimport { Readable } from \"node:stream\";\nimport { pipeline } from \"node:stream/promises\";\nimport path from \"node:path\";\nimport { RUNS_DIR } from \"@/lib/paths\";\n\nexport async function POST(request: NextRequest) {\n  try {\n    const formData = await request.formData();\n    const videoFile = formData.get(\"video\") as File | null;\n    const script = formData.get(\"script\") as string | null;\n\n    if (!videoFile) {\n      return NextResponse.json({ error: \"No video file provided\" }, { status: 400 });\n    }\n    if (!script || script.trim().length === 0) {\n      return NextResponse.json({ error: \"No script provided\" }, { status: 400 });\n    }\n\n    // Create timestamped run directory\n    const now = new Date();\n    const stamp = now\n      .toISOString()\n      .replace(/T/, \"_\")\n      .replace(/:/g, \"\")\n      .replace(/\\..+/, \"\")\n      .slice(0, 15);\n    const runDir = path.join(RUNS_DIR, stamp);\n\n    await mkdir(runDir, { recursive: true });\n    await mkdir(path.join(runDir, \"shorts\"), { recursive: true });\n    await mkdir(path.join(runDir, \"finals\"), { recursive: true });\n    await mkdir(path.join(runDir, \"tmp\"), { recursive: true });\n\n    // Stream video to disk\n    const aRollPath = path.join(runDir, \"a-roll.mp4\");\n    const fileStream = videoFile.stream();\n    const writeStream = createWriteStream(aRollPath);\n    const nodeStream = Readable.fromWeb(fileStream as any);\n    await pipeline(nodeStream, writeStream);\n\n    // Save script\n    await writeFile(path.join(runDir, \"script.txt\"), script);\n\n    // Write empty assets.json (no Drive pull in upload flow)\n    await writeFile(\n      path.join(runDir, \"assets.json\"),\n      JSON.stringify({ broll: [], graphs: [], sfx: [] }, null, 2),\n    );\n\n    console.log(`[upload] Created run ${stamp} â€” video: ${(videoFile.size / 1024 / 1024).toFixed(1)}MB`);\n\n    return NextResponse.json({ runId: stamp });\n  } catch (err: any) {\n    console.error(\"[upload] Error:\", err);\n    return NextResponse.json(\n      { error: err.message || \"Upload failed\" },\n      { status: 500 },\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,WAAW,MAAM,QAAQ,QAAQ;QACvC,MAAM,YAAY,SAAS,GAAG,CAAC;QAC/B,MAAM,SAAS,SAAS,GAAG,CAAC;QAE5B,IAAI,CAAC,WAAW;YACd,OAAO,uJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAyB,GAAG;gBAAE,QAAQ;YAAI;QAC9E;QACA,IAAI,CAAC,UAAU,OAAO,IAAI,GAAG,MAAM,KAAK,GAAG;YACzC,OAAO,uJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAqB,GAAG;gBAAE,QAAQ;YAAI;QAC1E;QAEA,mCAAmC;QACnC,MAAM,MAAM,IAAI;QAChB,MAAM,QAAQ,IACX,WAAW,GACX,OAAO,CAAC,KAAK,KACb,OAAO,CAAC,MAAM,IACd,OAAO,CAAC,QAAQ,IAChB,KAAK,CAAC,GAAG;QACZ,MAAM,SAAS,4HAAI,CAAC,IAAI,CAAC,iIAAQ,EAAE;QAEnC,MAAM,IAAA,8IAAK,EAAC,QAAQ;YAAE,WAAW;QAAK;QACtC,MAAM,IAAA,8IAAK,EAAC,4HAAI,CAAC,IAAI,CAAC,QAAQ,WAAW;YAAE,WAAW;QAAK;QAC3D,MAAM,IAAA,8IAAK,EAAC,4HAAI,CAAC,IAAI,CAAC,QAAQ,WAAW;YAAE,WAAW;QAAK;QAC3D,MAAM,IAAA,8IAAK,EAAC,4HAAI,CAAC,IAAI,CAAC,QAAQ,QAAQ;YAAE,WAAW;QAAK;QAExD,uBAAuB;QACvB,MAAM,YAAY,4HAAI,CAAC,IAAI,CAAC,QAAQ;QACpC,MAAM,aAAa,UAAU,MAAM;QACnC,MAAM,cAAc,IAAA,kIAAiB,EAAC;QACtC,MAAM,aAAa,iIAAQ,CAAC,OAAO,CAAC;QACpC,MAAM,IAAA,yJAAQ,EAAC,YAAY;QAE3B,cAAc;QACd,MAAM,IAAA,kJAAS,EAAC,4HAAI,CAAC,IAAI,CAAC,QAAQ,eAAe;QAEjD,yDAAyD;QACzD,MAAM,IAAA,kJAAS,EACb,4HAAI,CAAC,IAAI,CAAC,QAAQ,gBAClB,KAAK,SAAS,CAAC;YAAE,OAAO,EAAE;YAAE,QAAQ,EAAE;YAAE,KAAK,EAAE;QAAC,GAAG,MAAM;QAG3D,QAAQ,GAAG,CAAC,CAAC,qBAAqB,EAAE,MAAM,UAAU,EAAE,CAAC,UAAU,IAAI,GAAG,OAAO,IAAI,EAAE,OAAO,CAAC,GAAG,EAAE,CAAC;QAEnG,OAAO,uJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAM;IAC1C,EAAE,OAAO,KAAU;QACjB,QAAQ,KAAK,CAAC,mBAAmB;QACjC,OAAO,uJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,IAAI,OAAO,IAAI;QAAgB,GACxC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}